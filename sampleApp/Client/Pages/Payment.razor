@page "/payment/{AccountNum}/{AmountDue}/{MinDue?}"
@inject NavigationManager NavigationManager
@inject HttpClient Http

<div class="">

    @if (!string.IsNullOrEmpty(BmxSessionToken) && IsValidAccountNumber)
    {

        <div class="row g-3">
            <div class="col-md-12">
                @*<span>Summary</span>*@

                <div class="card">

                    <!--<div class="d-flex justify-content-between p-3">

                    <div class="d-flex flex-column">

                        <span>Amout Due </span>-->
                    @*<a href="#" class="billing">Save 20% with annual billing</a>*@
                    @*<i class="fa fa-caret-down"></i>*@
                    <!--</div>

                    <div class="mt-1">
                        <sup class="super-price">$@AmountDue</sup>-->
                    @* <span class="super-month">/Month</span>*@
                    <!--</div>

                    </div>-->
                    @*  <hr class="mt-0 line">*@



                    @*<hr class="mt-0 line">*@
                    <div class="p-3">

                        <div class="d-flex justify-content-between">
                            <div class="accordion" id="paymentSummaryAccordion" style="">
                                <div class="card-header p-0" style="margin-bottom: 10px;" id="headingSelection">
                                    <span class="mb-0">
                                        <a class="" data-toggle="collapse" data-target="#collapseSelection" aria-expanded="true" aria-controls="collapseSelection">
                                            <span>Payable Amount <i class="fa fa-caret-down"></i></span>
                                        </a>
                                    </span>
                                </div>

                                <div id="collapseSelection" class="collapse" aria-labelledby="headingSelection" data-parent="#paymentSummaryAccordion" style="">
                                    <div class="row m-0 border">
                                        <div class="col-6 ">
                                            <span class="d-block py-2">Total Amount</span>
                                            <span class="d-block py-2">Minimum Due</span>
                                            <span class="d-block py-2">Other Amount</span>
                                        </div>
                                        <div class="col-3 text-center p-0">
                                            <span class="d-block p-2 "><span class="fas fa-dollar-sign"></span>@AmountDue</span>
                                            <span class="d-block p-2"><span class="fas fa-dollar-sign"></span>@MinDue</span>
                                            <span class="d-block p-2"><input type="number" @oninput="(e)=> PayableAmount = e.Value.ToString()" name="txtOtherAmount" id="txtOtherAmount" style="height:auto" class="form-control form-control-sm" autocomplete="off" value="" placeholder="$"></span>
                                        </div>
                                        <div class="col-3 p-0 text-center border-end">
                                            <span class="d-block py-2">
                                                <input type="radio" class="" data-value="@AmountDue" name="amountradio" value="@AmountDue" @onchange="OnChange" checked="">
                                            </span>
                                            <span class="d-block py-2 "><input type="radio" class="" data-value="@MinDue" @onchange="OnChange" name="amountradio" value="@MinDue"></span>
                                            <span class="d-block py-2 "><input type="radio" class="" data-value="0" @onchange="OnChange" name="amountradio" value="0"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <span class="" id="payableAmountLabel">$@PayableAmount</span>
                        </div>

                    </div>

                    <div class="p-3">

                        <div class="d-flex justify-content-between mb-2">
                            <span>Account Number</span>
                            <span>@AccountNum</span>
                        </div>

                        <div class="d-flex justify-content-between mb-2">
                            <span>Last Statement Date</span>
                            <span>May 15</span>
                        </div>
                        <div class="d-flex justify-content-between">
                            <span>Due Date</span>
                            <span>May 30</span>
                        </div>

                    </div>
                    <hr class="mt-0 line" />

                    <div style="padding-left:1em">
                        <span class="mb-0">
                            <span>
                                <span>Pay With <i class="fa fa-angle-down"></i></span>
                            </span>
                        </span>
                    </div>
                    @*<div class="p-3 d-flex "><span>Make Payment using </span></div>*@
                    <div class="p-3 d-flex justify-content-between">
                        <div class="card">
                            <div class="accordion" id="accordionExample" style="">
                                <div class="card">
                                    <div class="card-header p-0" id="headingTwo">
                                        <h2 class="mb-0">


                                            <button class="btn btn-light btn-block text-left p-3 rounded-0" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <span>Credit card</span>
                                                    <div class="icons">
                                                        <i class="fa fa-credit-card"></i>
                                                    </div>

                                                </div>
                                            </button>
                                        </h2>
                                    </div>
                                    <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordionExample">


                                        <div class="card-body payment-card-body">

                                            <span class="font-weight-normal card-text">Card Number</span>
                                            <div class="input">
                                                <i class="fa fa-credit-card"></i>
                                                <input type="tel" class="form-control" maxlength="16" required placeholder="0000 0000 0000 0000">
                                            </div>

                                            <div class="row mt-3 mb-3">

                                                <div class="col-md-6">

                                                    <span class="font-weight-normal card-text">Expiry Date</span>
                                                    <div class="input">

                                                        <i class="fa fa-calendar"></i>
                                                        <input type="text" class="form-control" placeholder="MM/YY">

                                                    </div>

                                                </div>


                                                <div class="col-md-6">

                                                    <span class="font-weight-normal card-text">CVC/CVV</span>
                                                    <div class="input">

                                                        <i class="fa fa-lock"></i>
                                                        <input type="password" maxlength="3" class="form-control" placeholder="000">

                                                    </div>

                                                </div>


                                            </div>
                                            <div class="row mt-3 mb-3">

                                                <div class="col-md-6">
                                                    <span class="font-weight-normal card-text">Name on the Card</span>
                                                    <div class="input">

                                                        <i class="fa fa-user-secret" aria-hidden="true"></i>
                                                        <input type="text" class="form-control" placeholder="Name displayed on your physical credit card">

                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <span class="font-weight-normal card-text">Zip</span>
                                                    <div class="input">

                                                        <i class="fa fa-address-card" aria-hidden="true"></i>
                                                        <input type="text" class="form-control" placeholder="Zip code of your credit card communication address">

                                                    </div>
                                                </div>

                                            </div>


                                            <span class="text-muted certificate-text"><i class="fa fa-lock"></i> Your transaction is secured with ssl certificate</span>
                                            <div class="p-3">

                                                <button class="btn btn-primary btn-block free-button" @onclick="PaynowCardClick" style=" display: block;">
                                                    @if (ShowProgressbtn)
                                                    {
                                                        <span class="spinner-grow spinner-grow-sm" role="status" aria-hidden="true"></span>
                                                        @ProgressMessage
                                                    }
                                                    else
                                                    {
                                                        @ButtonText
                                                    }
                                                </button>

                                            </div>
                                        </div>

                                    </div>
                                </div>

                                <div class="card">
                                    <div class="card-header p-0">
                                        <h2 class="mb-0">
                                            <button class="btn btn-light btn-block text-left collapsed p-3 rounded-0 border-bottom-custom" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <span>Bank ACH</span>
                                                    <i class="fa fa-university"></i>
                                                </div>
                                            </button>
                                        </h2>
                                    </div>

                                    <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionExample">

                                        <div class="card-body payment-card-body">
                                            <div class="row mt-3 mb-3">

                                                <div class="col-md-12">
                                                    <span class="font-weight-normal card-text">Bank Route Number</span>
                                                    <div class="input">
                                                        <i class="fa fa-info" aria-hidden="true"></i>
                                                        <input type="text" class="form-control" placeholder="ex:011002550">
                                                    </div>
                                                    <span class="font-weight-normal card-text">Checking Account Number</span>
                                                    <div class="input">
                                                        <i class="fa fa-info" aria-hidden="true"></i>
                                                        <input type="text" class="form-control" placeholder="ex:9900990094">
                                                    </div>

                                                </div>
                                            </div>

                                            <div class="row mt-3 mb-3">

                                                <div class="col-md-6">

                                                    <span class="font-weight-normal card-text">First Name</span>
                                                    <div class="input">

                                                        <i class="fa fa-info"></i>
                                                        <input type="text" class="form-control" placeholder="As per bank records">

                                                    </div>

                                                </div>


                                                <div class="col-md-6">

                                                    <span class="font-weight-normal card-text">Last Name</span>
                                                    <div class="input">

                                                        <i class="fa fa-info"></i>
                                                        <input type="text" class="form-control" placeholder="As per bank records">

                                                    </div>

                                                </div>


                                            </div>
                                            <div class="p-3">
                                                <button class="btn btn-primary btn-block free-button" style=" display: block;">Pay Now</button>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                <div class="card">
                                    <div class="card-header p-0">
                                        <h2 class="mb-0">
                                            <button class="btn btn-light btn-block text-left collapsed p-3 rounded-0 border-bottom-custom" type="button" data-toggle="collapse" data-target="#collapseWallet" aria-expanded="false" aria-controls="collapseWallet">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <span>Saved Wallets</span>
                                                    <i class="fa fa-wallet"></i>
                                                </div>
                                            </button>
                                        </h2>
                                    </div>

                                    <div id="collapseWallet" class="collapse" aria-labelledby="" data-parent="#accordionExample">

                                        <div class="card-body payment-card-body">
                                            Saved Wallet from previous sessions will be shown here.
                                        </div>
                                    </div>

                                </div>

                                <div class="card">
                                    <div class="card-header p-0">
                                        <h2 class="mb-0">
                                            <button class="btn btn-light btn-block text-left collapsed p-3 rounded-0 border-bottom-custom" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <span>Apple Pay</span>
                                                    <i class="fab fa-apple-pay"></i>
                                                </div>
                                            </button>
                                        </h2>
                                    </div>

                                    <div id="collapseThree" class="collapse" aria-labelledby="" data-parent="#accordionExample">
                                        <div class="card-body payment-card-body">
                                            <button class="btn btn-secondary btn-block free-button" data-toggle="modal" data-target="#bottom_modal" style=" display: block;">Pay With <i class="fab fa-apple-pay"></i></button>
                                        </div>
                                    </div>

                                </div>

                                <div class="card">
                                    <div class="card-header p-0">
                                        <h2 class="mb-0">
                                            <button class="btn btn-light btn-block text-left collapsed p-3 rounded-0 border-bottom-custom" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <span>Google Pay</span>
                                                    <i class="fab fa-google-pay"></i>
                                                </div>
                                            </button>
                                        </h2>
                                    </div>

                                    <div id="collapseFour" class="collapse" aria-labelledby="" data-parent="#accordionExample">

                                        <div class="card-body payment-card-body">
                                            To be added soon..
                                        </div>
                                    </div>

                                </div>





                            </div>


                        </div>


                    </div>





                </div>


            </div>




        </div>

    }

    else
    {

        <div class="spinner-grow" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <label>
            Please wait..Connecting to Payment API and creating a session for you..
        </label>
    }
</div>

<div class="modal bottom fade" id="bottom_modal" tabindex="-1" aria-labelledby="bottom_modal" style="display: none;" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" style="font-size: 2.25rem; ">
                    <i class="fab fa-apple-pay"></i>
                </h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" style=" margin-top: 0px;">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            <div class="modal-body">

                <div class="row">
                    <div class="col">
                        <p style="color:grey">CARD &amp; BILLING</p>
                    </div>
                    <div class="col-8">
                        <div class="row">
                            <div class="col-4">
                                <img src="/images/icons8-credit-card-contactless-80.png">
                            </div>
                            <div class="col-8">
                                <p>
                                    PLATINUM CARD (..7070)<br>
                                    <small>1455 MARKET ST UNIT 600 SAN FRAN...</small>
                                </p>
                            </div>
                        </div>
                    </div>
                    <div class="col">
                        <i class="fa fa-arrows-up-down"></i>
                    </div>
                </div>
                <hr />
                <div class="row">
                    <div class="col">
                        &nbsp;
                    </div>
                    <div class="col-10">
                        <div class="row">
                            <div class="col">
                                <p style="color:grey">TOTAL PAYABLE AMOUNT</p>
                            </div>
                            <div class="col">
                                <p style="line-height: 3em ">$@PayableAmount</p>

                            </div>
                        </div>
                    </div>
                   
                </div>

            </div>
            <hr>
            <div class="d-flex flex-column align-items-center">
                <svg enable-background="new 0 0 283.46 283.46" height="64px" id="Layer_1" version="1.1" viewBox="0 0 283.46 283.46" width="64px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><g><path d="M22.855,81.087    C9.543,107.082,4.61,137.596,10.832,168.451" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M200.875,21.835    c-25.543-12.538-55.271-17.06-85.321-11.001c-34.136,6.882-62.593,26.187-81.618,52.257" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M273.164,115.555    c-7.06-35.013-27.189-64.056-54.285-83.07" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path></g></g><g><g><path d="M275.877,144.695    c0.184-9.594-0.666-19.357-2.641-29.154" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M10.904,168.438    c0.388,1.921,0.814,3.824,1.279,5.709" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path></g></g><path d="M107.454,271.29  c29.977-34.119,44.249-81.34,34.579-129.294" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M119.176,220.338  c-6.555,16.798-16.443,32.131-29.02,45.026" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M126.187,274.896  c29.051-37.175,42.302-86.333,32.245-136.205l0.052-0.017c-1.836-9.104-10.703-14.996-19.807-13.16  c-9.103,1.836-14.994,10.703-13.159,19.808l0.119-0.02c3.746,18.581,3.45,37.04-0.284,54.465" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M110.51,156.144  c5.245,38.701-9.215,76.082-36.162,101.293" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M178.494,171.434  c-0.033-11.89-1.227-23.95-3.666-36.049l0.037-0.014c-3.659-18.152-21.34-29.901-39.492-26.24  c-13.559,2.734-23.546,13.292-26.203,26.027" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M146.273,275.748  c16.744-24.469,27.606-52.939,31.045-83.098" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M145.93,91.898  c-4.529-0.353-9.184-0.093-13.859,0.85c-27.201,5.485-44.805,31.979-39.32,59.182l0.094-0.016  c7.418,36.792-6.293,72.938-32.779,95.876" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M167.608,273.324  c24.108-41.098,33.776-90.867,23.617-141.246l0.024-0.01c-3.023-14.988-12.424-27.063-24.807-33.967" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M72.457,201.992  c-5.228,13.461-13.877,25.422-25.095,34.611" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M209.084,207.06  c4.162-25.266,3.9-51.697-1.461-78.287l0.01-0.007c-7.31-36.25-42.617-59.709-78.865-52.4c-36.25,7.31-59.71,42.618-52.4,78.869  l0.078-0.016c1.736,8.61,2.084,17.178,1.197,25.47" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M190.006,266.909  c6.068-12.456,10.967-25.52,14.582-39.021" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M209.666,92.758  c6.883,9.447,11.887,20.496,14.35,32.705l0.005,0.004c9.095,45.104,4.563,89.789-10.744,129.806" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M107.07,65.952  c5.76-2.64,11.913-4.663,18.393-5.969c25.609-5.163,50.842,1.962,69.588,17.315" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M36.275,224.05  c18.902-15.185,28.896-40.118,23.771-65.524l-0.063,0.014c-6.366-31.567,5.94-62.562,29.315-81.544" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M41.684,145.976  c0.215,5.25,0.844,10.552,1.916,15.867l0.051-0.013c3.752,18.607-3.295,36.881-16.821,48.343" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M242.69,135.156  c-0.642-4.326-1.399-8.658-2.272-12.994l-0.02-0.001C229.44,67.813,176.506,32.643,122.16,43.6  c-41.765,8.422-72.207,41.635-79.088,81.229" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M236.983,236.258  c6.826-25.603,9.664-52.564,7.931-80.029" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M157.688,25.931  c-12.592-1.701-25.675-1.366-38.83,1.287C55.461,40,14.432,101.75,27.215,165.146l0.039-0.01c2.219,11-1.225,21.823-8.313,29.47" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path><path d="M260.104,204.896  c3.479-27.945,2.584-56.916-3.289-86.041l-0.033,0.002c-8.693-43.112-40.031-75.878-79.129-88.413" fill="none" stroke="#c75454" stroke-linecap="round" stroke-miterlimit="10" stroke-width="8"></path></svg>
                <span>Pay with Touch ID</span>
            </div>
        </div>
    </div>
</div>

@code {

    [Parameter]
    public string AccountNum { get; set; }

    [Parameter]
    public string AmountDue { get; set; }

    [Parameter]
    public string? MinDue { get; set; }

    string PayableAmount = "0";

    bool ShowProgressbtn = false;

    string CreditCardNumber = "";

    string ProgressMessage = "Please wait... Processing payment";

    string ButtonText = "Pay Now";

    string BmxSessionToken = string.Empty;

    bool IsValidAccountNumber = false;

    BlockingResult AvailablePaymentMethods = new();

    private void OnChange(ChangeEventArgs args)
    {
        //CurrentValueAsString = args.Value.ToString();
        PayableAmount = args.Value.ToString();
    }


    protected override async Task OnInitializedAsync()
    {

        PayableAmount = AmountDue;
        MinDue = MinDue ?? "9.99";
        var sessionTokenReq = new SessionTokenRequest()
        {
            AgentId = null,
            BillingAccount = AccountNum ?? "900110323",
            UserId = AccountNum ?? "900110323",
            UiChannel = "Web"
        };

        StringContent stringContent = new(JsonConvert.SerializeObject(sessionTokenReq), Encoding.UTF8,
                                     "application/json");
        var responseSession = await Http.PostAsync("payment/session/create/1234", stringContent).ConfigureAwait(true);
        if (responseSession.IsSuccessStatusCode)
        {
            var responseText = await responseSession.Content.ReadAsStringAsync().ConfigureAwait(true);
            var sessionToken = JsonConvert.DeserializeObject<SessionTokenResponse>(responseText);
            BmxSessionToken = sessionToken.SessionToken;

        }

        if (!string.IsNullOrEmpty(BmxSessionToken))
        {
            if (!Http.DefaultRequestHeaders.Any(d => d.Key == "x-SessionToken")) Http.DefaultRequestHeaders.Add("x-SessionToken", BmxSessionToken);
            var accountValidationResponse = await Http.PostAsync("payment/account/validation", null).ConfigureAwait(true);
            if (accountValidationResponse.IsSuccessStatusCode)
            {
                var responseText = await accountValidationResponse.Content.ReadAsStringAsync().ConfigureAwait(true);
                var billingAccountResponse = JsonConvert.DeserializeObject<BillingAccountResponse>(responseText);
                IsValidAccountNumber = billingAccountResponse.billingAccountDetail.billingAccountLookupResponse.isAccountFound;
                AvailablePaymentMethods = billingAccountResponse.billingAccountDetail.billingAccountAcceptanceResponse.blockingResult;
            }
            else
                IsValidAccountNumber = true;

        }

        Console.WriteLine("BmxSessionToken value receieved " + BmxSessionToken);
        Console.WriteLine("IsValidAccountNumber " + IsValidAccountNumber);


    }
    private async Task PaynowCardClick()
    {
        ShowProgressbtn = true;
        FundingAccountCardResponse FundingAccountCardResponse = new();
        PaymentResponse paymentResponse = new();
        await Task.Delay(5000);

        if (!string.IsNullOrEmpty(BmxSessionToken))
        {
            FundingAccountCardRequest fundingAccountCardRequest = new()
            {

                cardDetail = new CardDetail
                {
                    cardNumber = "4100010000000562",
                    expirationDate = "0624",
                    securityCode = "666",
                    zipCode = "75231",
                    firstName = "Nana",
                    lastName = "Saheb",
                    nameOnCard = "Nanasaheb Raktate"
                }
            };

            StringContent stringContent = new(JsonConvert.SerializeObject(fundingAccountCardRequest), Encoding.UTF8,
                                         "application/json");

            if (!Http.DefaultRequestHeaders.Any(d => d.Key == "x-SessionToken")) Http.DefaultRequestHeaders.Add("x-SessionToken", BmxSessionToken);
            var responseMessage = await Http.PostAsync("payment/account/funding/card", stringContent).ConfigureAwait(true);
            if (responseMessage.IsSuccessStatusCode)
            {
                var responseText = await responseMessage.Content.ReadAsStringAsync().ConfigureAwait(true);
                FundingAccountCardResponse = JsonConvert.DeserializeObject<FundingAccountCardResponse>(responseText);
                Console.WriteLine(FundingAccountCardResponse);
            }
            if (!string.IsNullOrEmpty(FundingAccountCardResponse?.fundingAccountValidationResult?.fundingAccount?.fundingAccountToken))
            {
                Console.WriteLine("Received the funding token " + FundingAccountCardResponse?.fundingAccountValidationResult?.fundingAccount?.fundingAccountToken);
                //if(!Http.DefaultRequestHeaders.Any(d=>d.Key == "x-SessionToken")) Http.DefaultRequestHeaders.Add("x-SessionToken", BmxSessionToken);

                PaymentRequest paymentRequest = new PaymentRequest
                {
                    paymentAmount = 66.00,
                    paymentCustomList = null,
                    addToWallet = true,
                    fundingAccountToken = FundingAccountCardResponse?.fundingAccountValidationResult?.fundingAccount?.fundingAccountToken,
                    zipCode = 48038,
                    securityCode = null,
                    emailAddress = "Nanasaheb.Raktate@fiserv.com",
                    transactionNote = "APIPaymentfor BSC",
                    allowDuplicatePayment = true,
                    paymentType = "BILL_PAYMENT"
                };
                StringContent stringapymentrequestContent = new(JsonConvert.SerializeObject(paymentRequest), Encoding.UTF8,
                                        "application/json");
                var responsePayment = await Http.PostAsync("payment/make", stringapymentrequestContent).ConfigureAwait(true);

                if (responsePayment.IsSuccessStatusCode)
                {

                    var responseText = await responsePayment.Content.ReadAsStringAsync().ConfigureAwait(true);
                    Console.WriteLine(responseText);
                    paymentResponse = JsonConvert.DeserializeObject<PaymentResponse>(responseText);
                    if (paymentResponse.result.StatusCode == "Success")
                    {
                        //NavigationManager.NavigateTo("pay/1234");
                    }
                }
            }

        }
        NavigationManager.NavigateTo($"pay/{paymentResponse.paymentEventID}");
    }
}
